{{- define "main" }}

<article class="post-single">
  <header class="post-header">
    {{ partial "breadcrumbs.html" . }}
    <h1 class="post-title">
      <a href="{{ .Permalink }}">{{ .Title }}</a>
      {{- if .Draft }}<sup><span class="entry-isdraft">&nbsp;&nbsp;[draft]</span></sup>{{- end }}
    </h1>
    {{- if .Description }}
    <div class="post-description">
      {{ .Description }}
    </div>
    {{- end }}
    {{- if not (.Param "hideMeta") }}
    <div class="post-meta">
      {{- partial "post_meta.html" . -}}
      <!--åœ¨å¤´éƒ¨æ˜¾ç¤ºå¯è·³è½¬çš„æ ‡ç­¾-->
    &nbsp;|&nbsp;æ ‡ç­¾: &nbsp;
    {{- if .Params.tags }}
    <ul class="post-tags-meta">
        {{- range $index, $value := ($.GetTerms "tags") }}
        {{- if eq $index 0}}
        <a href="{{ .Permalink }}">{{ .LinkTitle }}</a>
        {{- else }}
        <a href="{{ .Permalink }}">ã€{{ .LinkTitle }}</a>
        {{- end }}
        {{- end }}
    </ul>
    {{- end }}

    <!--è®¿é—®é‡-->
    <!--ä¹Ÿå¯ä»¥ç”¨twikooè¯„è®ºå¸¦çš„è®¿é—®æ–¹å¼ï¼Œå¦‚ä¸‹ï¼š-->
    <!-- <span id="twikoo_visitors"></span>    -->
    <!--å¦‚ä¸‹æ˜¯ä½¿ç”¨busuanziçš„æ–¹å¼ï¼Œè®°å¾—å¼•å…¥busuanziçš„jsï¼Œå¦‚æœåœ¨å…¶ä»–æ–‡ä»¶å¼•å…¥äº†ï¼Œè¿™é‡Œå¯ä»¥ä¸ç”¨å¼•å…¥-->
    <!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container_page_pv">
        &nbsp;| è®¿é—®: <span id="busuanzi_value_page_pv"></span>
    </span> -->

    
    <!--è¯„è®ºæ•°-->
    <!--æ ¹æ®twikooæä¾›çš„æ¥å£æ–‡æ¡£ä¿®æ”¹ï¼šhttps://twikoo.js.org/api.html-->
    <!--è¦å¼•å…¥twikooçš„jsï¼Œ.Site.Params.twikoo.versionæ˜¯æˆ‘è‡ªå·±çš„å†™æ³•ï¼Œè®©ç‰ˆæœ¬åœ¨config.ymlé…ç½®æ–‡ä»¶æ§åˆ¶-->
    <script src="https://cdn.staticfile.org/twikoo/{{ .Site.Params.twikoo.version }}/twikoo.all.min.js">
    </script>
    <script>
        let url = document.documentURI
        {{ $baseURL := .Site.BaseURL }}
        let dnsUrl = {{ $baseURL }}
        let urlSplit = url.split(dnsUrl)
        let finalUrl = urlSplit[1]
        if (finalUrl[0] !== '/') {
            finalUrl = '/'+finalUrl
        }
        twikoo.getCommentsCount({
            envId: {{ .Site.Params.twikoo.id }},
            region: {{ .Site.Params.twikoo.region }},
            urls: [
                finalUrl,
            ],
            includeReply: true // è¯„è®ºæ•°æ˜¯å¦åŒ…æ‹¬å›å¤ï¼Œé»˜è®¤ï¼šfalse
        }).then(function (res) {
            let count = res[0].count
            const obj = document.getElementById("comment_count");
            obj.innerText = count
            // è¿”å›ç¤ºä¾‹: [
            //   { url: '/2020/10/post-1.html', count: 10 },
            // ]
        }).catch(function (err) {
            // å‘ç”Ÿé”™è¯¯
            console.error(err);
        });
    </script>
    &nbsp;| è¯„è®º: &nbsp; <span id="comment_count"></span>
      {{- partial "translation_list.html" . -}}
      {{- partial "edit_post.html" . -}}
      {{- if (not .Site.Params.disableBuSuanZi) }}
      &nbsp;| &nbsp;<span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span>&nbsp;Hits
      {{- end}}
    </div>
    {{- end }}
  </header>
  {{- $isHidden := .Params.cover.hidden | default .Site.Params.cover.hiddenInSingle | default .Site.Params.cover.hidden }}
  {{- partial "cover.html" (dict "cxt" . "IsHome" false "isHidden" $isHidden) }}
  {{- if (.Param "ShowToc") }}
  {{- partial "toc.html" . }}
  {{- end }}

 <!-- {{- if .Site.Params.googleAdSense }} -->
 <!-- &lt;!&ndash; header-ad &ndash;&gt; -->
 <!-- <ins class="adsbygoogle"
      style="display:block"
      data-ad-client="{{ .Site.Params.googleAdSense }}"
      data-ad-slot="9161921641"
      data-ad-format="auto"
      data-full-width-responsive="true"></ins> -->
 <!-- <script>
   (adsbygoogle = window.adsbygoogle || []).push({});
 </script> -->
  <!-- {{ end -}} -->

  {{- if .Content }}
  <div class="post-content">
    {{ partial "breadcrumb.html" . }}
    {{- if and (.Site.Params.ShowReprinted) (not .Params.DisableReprinted) }}
    <!-- <blockquote style="margin-top: 8px">
      <p style="text-align:center;text-indent:0rem">
        <a href="{{ .Permalink }}">æœ¬æ–‡</a>
        é¦–å‘äº
        <a href="{{ $.Site.BaseURL }}">{{ $.Site.Params.ProfileMode.Title }}</a>ï¼Œ
        <a href="/disclaimer/">è½¬è½½</a> è¯·æ³¨æ˜
        <a href="{{ .Permalink }}">æ¥æº</a>ã€‚
      </p>
    </blockquote> -->
    {{ end -}}
    {{- if not (.Param "disableAnchoredHeadings") }}
    {{- partial "anchored_headings.html" .Content -}}
    {{- else }}{{ .Content }}{{ end }}
    <!-- <div class="post-remark">
    </hr>
      æ³¨ï¼šæœ¬ä½œå“é‡‡ç”¨<a rel="license" target="view_window" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"> çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…è®¸å¯åè®® </a>è¿›è¡Œè®¸å¯ã€‚
    </div> -->

  </div>
  {{- end }}

  <footer class="post-footer">
    {{- if .Params.tags }}
    <ul class="post-tags">
      {{- range ($.GetTerms "tags") }}
      <li><a href="{{ .Permalink }}"> ğŸ· {{ .LinkTitle }}</a></li>
      {{- end }}
    </ul>
    {{- end }}
    {{- if (and .Site.Params.ShowShareButtons (ne .Params.disableShare true)) }}
    {{- partial "share_icons.html" . -}}
    {{- end }}
    {{- if (.Param "ShowPostNavLinks") }}
    {{- partial "post_nav_links.html" . }}
    {{- end }}
  </footer>

  {{ if and (.Params.comments | default .Site.Params.enableComments) (eq hugo.Environment "production") }}
    {{ if or (in .Site.Params.mainSections .Section) .Params.comments }}

        {{ if not .Site.Params.autoLoadComments }}
            <div class="load-comments">
                <div id="load-comments">{{ i18n "loadComments" }}</div>
            </div>  
        {{  end }}
        
    {{ end }}
{{ end }}  

  {{ if not (eq .Params.Comments "false") }}
        {{ partial "comments/twikoo.html" . }}
    {{ end }}
   
  {{ if not (eq .Params.Comments "false") }}
        {{ partial "comments/disqus.html" . }}
    {{ end }}
  
  {{ if not (eq .Params.Comments "false") }}
        {{ partial "comments/livere.html" . }}
    {{ end }}

  {{ if not (eq .Params.Comments "false") }}
        {{ partial "comments/waline.html" . }}
    {{ end }}
  
  {{ if not (eq .Params.Comments "false") }}
        {{ partial "comments/artalk.html" . }}
    {{ end }}
</article>

{{- end }}{{/* end main */}}
